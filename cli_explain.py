#!/usr/bin/env python
import argparse
import sys

from androidcrypto.analysis.explainability.config import parse_explainability_config
from androidcrypto.analysis.explainability.api import explain_based_on_config

def main() -> None:
    
    parser = argparse.ArgumentParser(description="Explain a model")
    parser.add_argument(
        "config_path",
        metavar="CONFIG_PATH", 
        type=str, 
        help="path to config file in yaml"
    )
    args = parser.parse_args()
    path = args.config_path

    config = parse_explainability_config(path)
    if config is None:
        print("Invalid config.")
        exit(1)

    try:
        explain_based_on_config(config)
    except KeyboardInterrupt:
        print('Interrupted with CTRL+C, exiting.')
        sys.exit(130)


if __name__ == "__main__":
    main()

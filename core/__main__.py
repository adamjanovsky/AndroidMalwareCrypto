import argparse
import core.tasks as tasks

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Cryptography in malicious android apps core')
    actions = ['word_statistics', 'base64']
    parser.add_argument('-a', '--action', type=str, choices=actions, help='action to perform', required=True)
    parser.add_argument('-i', '--input', type=str, help='input folder path', required=True)
    parser.add_argument('-o', '--output', type=str, help='output folder path', required=True)
    parser.add_argument('-w', '--words', nargs='+', help='words to search in apks code', required=False)
    parser.add_argument('-c', '--imports', dest='imports', action='store_true', default=False)

    args = parser.parse_args()

    if args.action == 'word_statistics':
        print(args.imports)
        tasks.compute_word_statistics(args.input, args.output, args.words, args.imports)
    elif args.action == 'base64':
        tasks.decode_bas64(args.input, args.output)

FROM ubuntu:22.04

ARG NB_USER=user
ARG NB_UID=11
ENV USER ${NB_USER}
ENV HOME /home/${NB_USER}

RUN adduser --disabled-password \
    --gecos "Default user" \
    --uid ${NB_UID} \
    ${NB_USER}

WORKDIR ${HOME}

# Install Java JDK
ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get update \
    && apt-get install openjdk-8-jdk -y

# Install Python
RUN apt-get install software-properties-common -y \
    && apt-get install python3

# Install utils
RUN apt-get install git curl unzip wget -y

RUN wget https://github.com/skylot/jadx/releases/download/v1.2.0/jadx-1.2.0.zip \
    && mkdir jadx \
    && unzip jadx-1.2.0.zip -d jadx \
    && cd
ENV PATH="/home/user/jadx/bin/:$PATH"

# Start virtual environment
ENV VENV=/home/user/venv
RUN apt-get install python3-venv -y \
    && python3 -m venv $VENV
ENV PATH="$VENV/bin:$PATH"

# Install our tool and requirements
RUN apt-get install build-essential python3-dev python3-setuptools -y \
    && git clone https://github.com/adamjanovsky/AndroidMalwareCrypto \
    && cd AndroidMalwareCrypto \
    && pip3 install wheel \
    && pip3 install -r requirements.txt \
    && chmod +x ./examples/sample_experiment/execute_sample_experiment.sh \
    && cd

# Install patched Literadar and Python2 for LiteRadar
RUN git clone https://github.com/adamjanovsky/LiteRadar \
    && apt-get install python2 -y

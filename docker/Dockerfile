FROM ubuntu

ARG NB_USER=user
ARG NB_UID=11
ENV USER ${NB_USER}
ENV HOME /home/${NB_USER}

RUN adduser --disabled-password \
    --gecos "Default user" \
    --uid ${NB_UID} \
    ${NB_USER}

WORKDIR ${HOME}

# Install Java JDK
ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get update \
    && apt-get install openjdk-8-jdk -y

# Install Python 3.8
RUN apt-get install software-properties-common -y \
    && add-apt-repository ppa:deadsnakes/ppa -y \
    && apt-get install python3.8 -y

# Install git
RUN apt-get install git -y

# Install Jadx
RUN git clone https://github.com/skylot/jadx.git \
    && cd jadx \
    && ./gradlew dist \
    && cd
ENV PATH="/home/user/jadx/build/jadx/bin/:$PATH"

# Start virtual environment
ENV VENV=/home/user/venv
RUN apt-get install python3.8-venv -y \
    && python3 -m venv $VENV
ENV PATH="$VENV/bin:$PATH"

# Install our tool and requirements
RUN apt-get install build-essential python3-dev python3-setuptools -y \
    && git clone https://github.com/adamjanovsky/AndroidMalwareCrypto \
    && cd AndroidMalwareCrypto \
    && python3 ./setup.py install \
    && cd

# Install patched Androguard
RUN git clone https://github.com/adamjanovsky/androguard \
    && cd androguard \
    && pip3 install -e . \
    && cd

# Install patched Literadar and Python2 for LiteRadar
RUN git clone https://github.com/adamjanovsky/LiteRadar \
    && apt-get install python2 -y

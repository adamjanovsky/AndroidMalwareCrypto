from enum import Enum

LOGS_FILENAME = 'androidcrypto_log.txt'
META_FILENAME = 'meta.yml'
DATA_DIRNAME = 'data'

JSON_FILENAME = 'records.json'
PROCESSED_JSON_FILENAME = 'processed_records.json'
DX_DIRNAME = 'dx'
APK_DIRNAME = 'apk'

BLOCKSIZE = 65536

TIMEOUT_CONSTANT = 900
JSON_CHUNK_SIZE = 1000

BASE64_EXP_RESULTS_FILENAME = 'base64_deobfuscated'


class TaskName(Enum):
    DOWNLOAD = 'download'
    DECOMPILE = 'decompile'
    THIRD_PARTY_LIBS = 'third_party_libs'
    EVALUATE = 'evaluate'
    LABEL = 'label'

    def __str__(self):
        return str(self.value)

DATASET_BASE_DICT = {'metadata': {'androzoo_url': None, 'apk_path': None, 'dx_path': None}}

DOWNLOAD_STRATEGY_UNIFORM = 'uniform'


class StatusCode(Enum):
    OK = 'ok'
    FAILED_ON_DOWNLOAD = 'failed_on_download'
    FAILED_ON_DECOMPILE = 'failed_on_decompile'
    FAILED_ON_THIRD_PARTY = 'failed_on_third_party'
    FAILED_ON_EVALUATE = 'failed_on_evaluate'
    FAILED_TIMEOUT = 'failed_on_timeout'
    FAILED_UNKNOWN = 'failed_on_unknown'
    FAILED_LABEL = 'failed_on_label'


ALL_TASKS = 'all'


class EvaluateException(Exception):
    pass


class ThirdPartyException(Exception):
    pass


class DecompileException(Exception):
    pass


class DownloadException(Exception):
    pass


class LabelException(Exception):
    pass


class DatasetException(Exception):
    pass


class ExperimentException(Exception):
    pass

from typing import List, Union, Any, Optional

import pandas as pd
import numpy as np

def save_as_df_to_hdf(
    array: Union[pd.DataFrame, pd.Series, List[Any], np.array],
    path: str,
    key: str
    ) -> pd.DataFrame:
    """Saves given array of numbers as dataframe under given key into hdf (h5) file."""

    df = pd.DataFrame(array)
    df.to_hdf(path, key=key, format="table", append=True)
    return df

def safe_load_df_from_hdf(path: str, key: str) -> Optional[pd.DataFrame]:
    "Safely loads dataframe from hdf file if key is present there else returns None."

    try:
        return pd.read_hdf(path, key=key)
    except KeyError:
        return None
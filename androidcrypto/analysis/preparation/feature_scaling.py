"""
File contains class used for feature scaling.

Author: Dominik Macko
"""

from typing import List, Optional, Union

import pandas as pd
from sklearn.base import BaseEstimator, TransformerMixin
from sklearn_pandas import DataFrameMapper
from sklearn.preprocessing import StandardScaler

class FeatureScalerTransformer(BaseEstimator, TransformerMixin):
    """Feature scaler that uses standard scaling for numerical values excluding bools and specified columns."""
    
    def __init__(self,
                 columns: List[str]
                ):
        """
        Initializes feature scaler that uses standard scaling for given columns.
        
        columns - list of column names that are to be scaled using standard scaling
        """
        
        super().__init__()
        self._mapper: DataFrameMapper = DataFrameMapper(
            features=[([col], StandardScaler()) for col in columns],
            default=None,
            df_out=True
        )
        
    def fit(self,
            X: pd.DataFrame,
            y: Optional[Union[pd.DataFrame, pd.Series]]=None
           ) -> "FeatureScalerTransformer":
        """Fits transformer to given training data and returns self.
        
        X - dataframe to scale
        y - target labels, unused
        
        returns self
        """
        
        self._mapper.fit(X)
        return self
        
    def transform(self,
                  X: pd.DataFrame,
                  y: Optional[Union[pd.DataFrame, pd.Series]]=None
                 ) -> pd.DataFrame:
        """Transforms given dataframe by scaling it and returns it as a dataframe.
        
        X - dataframe to scale
        y - target labels, unused
        
        returns scaled X
        """
        
        return self._mapper.transform(X)

    
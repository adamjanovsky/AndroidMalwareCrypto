import requests
from androidcrypto.helpers import DownloadException
from stopit import TimeoutException


def download_worker(androzoo_path, apk_path):
    try:
        response = requests.get(androzoo_path)
        code = response.status_code
        if code != 200:
            raise DownloadException

        with open(apk_path, 'wb') as handle:
            handle.write(response.content)

    except Exception as e:
        if isinstance(e, TimeoutException):
            raise
        else:
            raise DownloadException

